"0","# Calculate accuracy on testing data"
"0","test.acc <- calibration_tbl %>%"
"0","    modeltime_accuracy(acc_by_id = TRUE)"
"0",""
"0","# Filter down to models with best MASE score by SKU"
"0","best.mase <- test.acc %>% "
"0","  group_by(sku) %>% "
"0","  filter(mase==min(mase)) %>% "
"0","  mutate(.model_desc = case_when("
"0","    grepl(""TBATS"",.model_desc)~""TBATS"","
"0","    grepl(""ARIMA"",.model_desc)~""ARIMA"","
"0","    grepl(""NNAR"",.model_desc)~""Feed For. NN"","
"0","    grepl(""ETS"",.model_desc)~""ETS"","
"0","    grepl(""LM"",.model_desc)~""Linear Regression"","
"0","    TRUE ~ .model_desc"
"0","  ))"
"0",""
"0","# Table"
"0","kable(best.mase %>% "
"0","  group_by(.model_desc) %>% "
"0","  summarize(n=n(),"
"0","            avg.MASE=mean(mase),"
"0","            med.MASE=median(mase)) %>% "
"0","  arrange(-n),"
"0","  col.names = c('Model', 'Num. of SKUs it was best for', 'Average MASE','Median MASE'),"
"0","  caption=""Average and Median MASE score for best fitting models"") %>% kable_styling(full_width = F)"
