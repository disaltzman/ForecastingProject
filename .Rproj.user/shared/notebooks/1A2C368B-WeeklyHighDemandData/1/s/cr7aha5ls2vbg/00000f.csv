"0",""
"0","# Create a dataframe with SKU's where old QueBIT approach was NOT the best"
"0","quebit.not.best <- best.test.weekly %>% "
"0","  group_by(sku) %>% "
"0","  filter(.model!=""QueBIT_Old"") %>%"
"0","  distinct(sku,.keep_all=T) %>%"
"0","  ungroup()"
"0",""
"0","# Get the accuracy of the old QueBIT approach on those SKU's"
"0","quebit.old.performance <- test.acc.weekly %>%"
"0","  filter(sku %in% quebit.not.best$sku) %>% "
"0","  filter(.model==""QueBIT_Old"")"
"0",""
"0","# Join tables together and calculate % improvement for new approach"
"0","new.improvement <- quebit.not.best %>% "
"0","  full_join(quebit.old.performance) %>%"
"0","  group_by(sku) %>% "
"0","  summarise(pct.improvement=1-(min(MASE)/max(MASE))) %>%"
"0","  mutate(pct.improvement=round(pct.improvement*100,2))"
"0",""
"0","# Create plot data and then plot comparison"
"0","plot_data <- full_join(quebit.old.performance,quebit.not.best) %>% "
"0","  mutate(x_label=ifelse(.model==""QueBIT_Old"",""QueBIT old approach"",""Best fitting new model""))"
"0",""
"0","ggplot(plot_data,aes(x_label,y=MASE)) + "
"0","  geom_boxplot() +"
"0","  geom_hline(yintercept=1,linetype=""dashed"") + "
"0","  stat_summary(fun=""mean"",shape=4,size=1,color=""red"") +"
"0","  ylab(""MASE Score (lower is better)"") +"
"0","  ggeasy::easy_remove_x_axis(""title"") + "
"0","  ggeasy::easy_text_size(16)"
